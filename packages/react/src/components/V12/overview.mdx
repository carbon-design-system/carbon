import { Meta } from '@storybook/blocks';

<Meta title="Getting Started/V12" />

# V12

[Source code](https://github.com/carbon-design-system/carbon/tree/main/packages/upgrade/transforms)

{/* prettier-ignore-start */}

{/* START doctoc generated TOC please keep comment here to allow auto update */}

{/* DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE */}

## Table of Contents

* [Overview](#overview)
* [Usage](#usage)
* [Feature Flag Codemods](#feature-flag-codemods)
  * [Enable v12 tile default icons](#enable-v12-tile-default-icons)
  * [Enable v12 overflowmenu](#enable-v12-overflowmenu)
  * [Enable v12 tile radio icons](#enable-v12-tile-radio-icons)
  * [Enable v12 structured list visible icons](#enable-v12-structured-list-visible-icons)
* [Other V12 Codemods](#other-v12-codemods)
  * [Light to layer](#light-to-layer)
  * [Slug prop to Decorator prop](#slug-prop-to-decorato-prop)
  * [FeatureFlag deprecate flags prop](#featureflag-deprecate-flags-prop)
* [TypeScript Support](#typescript-support)

{/* END doctoc generated TOC please keep comment here to allow auto update */}

{/* prettier-ignore-end */}

## Overview

Carbon provides codemods to help you migrate to v12 or enable v12 feature flags. Codemods are automated transformations that update your codebase, reducing the manual effort required when adopting new features.


## Usage

To run a specific codemod on your source files:

```bash
npx @carbon/upgrade migrate <codemod-name> --write
```

To list all available codemods:

```bash
npx @carbon/upgrade migrate list
```

## Feature Flag Codemods

The following codemods help you adopt changes introduced by v12 feature flags, which will be enabled by default in Carbon v12.

### Enable v12 tile default icons

Enables default icons for Tile components.

**Usage:**

```bash
npx @carbon/upgrade migrate enable-v12-tile-default-icons --write
```

This codemod wraps Tile components with `<FeatureFlags enableV12TileDefaultIcons>` and adds the necessary imports.

**Example:**

```jsx
// Before
import { Tile } from '@carbon/react';

<Tile>Content</Tile>

// After
import { Tile } from '@carbon/react';
import { FeatureFlags } from '@carbon/feature-flags';

<FeatureFlags enableV12TileDefaultIcons>
  <Tile>Content</Tile>
</FeatureFlags>
```

### Enable v12 overflowmenu

Updates OverflowMenu to use the new Menu-based implementation.

**Usage:**

The OverflowMenu codemod provides two different options:

1. With FeatureFlags wrapping (default):
```bash
npx @carbon/upgrade migrate enable-v12-overflowmenu --write
```

2. API migration only (for apps already using FeatureFlags at the root):
```bash
npx @carbon/upgrade migrate enable-v12-overflowmenu --wrap=false --write
```

This codemod:
- Converts `OverflowMenuItem` to `MenuItem` components
- Maps props: `itemText` → `label`, `isDelete` → `kind="danger"`
- Adds `MenuItemDivider` for items with `hasDivider`
- Optionally wraps with `<FeatureFlags enableV12Overflowmenu>` based on your needs

**Example with wrapping:**

```jsx
// Before
<OverflowMenu>
  <OverflowMenuItem itemText="Option 1" />
  <OverflowMenuItem itemText="Delete" isDelete />
</OverflowMenu>

// After
<FeatureFlags enableV12Overflowmenu>
  <OverflowMenu>
    <MenuItem label="Option 1" />
    <MenuItem label="Delete" kind="danger" />
  </OverflowMenu>
</FeatureFlags>
```

**Example without wrapping (API changes only):**

```jsx
// Before
<OverflowMenu>
  <OverflowMenuItem itemText="Option 1" />
  <OverflowMenuItem itemText="Delete" isDelete />
</OverflowMenu>

// After
<OverflowMenu>
  <MenuItem label="Option 1" />
  <MenuItem label="Delete" kind="danger" />
</OverflowMenu>
```

### Enable v12 tile radio icons

Enables default icons for RadioTile components.

**Usage:**

```bash
npx @carbon/upgrade migrate enable-v12-tile-radio-icons --write
```

This codemod wraps RadioTile components and TileGroups containing RadioTiles with `<FeatureFlags enableV12TileRadioIcons>`.

**Example:**

```jsx
// Before
<RadioTile value="option1">Option 1</RadioTile>

// After
<FeatureFlags enableV12TileRadioIcons>
  <RadioTile value="option1">Option 1</RadioTile>
</FeatureFlags>
```

### Enable v12 structured list visible icons

Makes icon components within StructuredList always visible.

**Usage:**

```bash
npx @carbon/upgrade migrate enable-v12-structured-list-visible-icons --write
```

This codemod:
- Adds the `selection` attribute to StructuredListRow components
- Removes custom CheckmarkFilled icons from cells
- Works with both direct components and those generated by functions

**Example:**

```jsx
// Before
<StructuredListWrapper selection>
  <StructuredListRow>
    <StructuredListCell>Data</StructuredListCell>
    <StructuredListCell>
      {isSelected && <CheckmarkFilled />}
    </StructuredListCell>
  </StructuredListRow>
</StructuredListWrapper>

// After
<StructuredListWrapper selection>
  <StructuredListRow selection>
    <StructuredListCell>Data</StructuredListCell>
  </StructuredListRow>
</StructuredListWrapper>
```

## Other V12 Codemods

### Light to layer

Replaces deprecated `light` prop with `Layer` component wrapping.

**Usage:**

```bash
npx @carbon/upgrade migrate refactor-light-to-layer --write
```

This codemod:
- Finds all components with the `light` prop
- Removes the `light` prop
- Wraps the component with `<Layer>`
- Adds the necessary Layer import

**Example:**

```jsx
// Before
import { Button } from '@carbon/react';

<Button light>Click me</Button>

// After
import { Button, Layer } from '@carbon/react';

<Layer>
  <Button>Click me</Button>
</Layer>
```

### Slug to decorator

Changes all occurrences of the `slug` prop to `decorator`.

**Usage:**

```bash
npx @carbon/upgrade migrate slug-prop-to-decorator-prop --write
```

**Example:**

```jsx
// Before
<Component slug="my-identifier">Content</Component>

// After
<Component decorator="my-identifier">Content</Component>
```

### FeatureFlag deprecate flags prop

Updates FeatureFlags component to use individual boolean props instead of the `flags` object.

**Usage:**

```bash
npx @carbon/upgrade migrate featureflag-deprecate-flags-prop --write
```

**Example:**

```jsx
// Before
<FeatureFlags flags={{ 'enable-v12-tile-default-icons': true }}>
  <App />
</FeatureFlags>

// After
<FeatureFlags enableV12TileDefaultIcons>
  <App />
</FeatureFlags>
```

## TypeScript Support

All codemods support TypeScript files (`.ts` and `.tsx`) in addition to JavaScript files (`.js` and `.jsx`).
